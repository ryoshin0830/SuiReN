// 得点/時間記録シートを生成
export const downloadScoreTimeSheet = () => {
  // HTMLコンテンツを作成
  const htmlContent = `
    <!DOCTYPE html>
    <html lang="ja">
    <head>
      <meta charset="UTF-8">
      <style>
        @page {
          size: A4 landscape;
          margin: 10mm;
        }
        body {
          font-family: "ヒラギノ角ゴ Pro W3", "Hiragino Kaku Gothic Pro", "メイリオ", Meiryo, "ＭＳ Ｐゴシック", sans-serif;
          padding: 10px;
          line-height: 1.4;
          color: #333;
        }
        .header {
          text-align: center;
          margin-bottom: 15px;
        }
        .title {
          font-size: 20px;
          font-weight: bold;
          margin-bottom: 3px;
        }
        .subtitle {
          font-size: 14px;
          color: #666;
          margin-bottom: 10px;
        }
        .info-section {
          margin-bottom: 15px;
          display: flex;
          gap: 40px;
          align-items: center;
        }
        .info-item {
          display: flex;
          align-items: center;
          gap: 10px;
        }
        .info-label {
          font-weight: bold;
        }
        .info-value {
          border-bottom: 1px solid #333;
          min-width: 200px;
          padding-bottom: 2px;
        }
        .main-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 20px;
        }
        .main-table th,
        .main-table td {
          border: 1px solid #333;
          padding: 4px;
          text-align: center;
          font-size: 12px;
        }
        .main-table th {
          background-color: #f0f0f0;
          font-weight: bold;
        }
        .session-header {
          background-color: #e8e8e8;
          font-weight: bold;
        }
        .data-cell {
          height: 20px;
          min-width: 50px;
        }
        .date-cell {
          min-width: 80px;
        }
        .notes-section {
          margin-top: 15px;
        }
        .notes-title {
          font-weight: bold;
          margin-bottom: 5px;
          font-size: 14px;
        }
        .notes-lines {
          border: 1px solid #ccc;
          min-height: 40px;
          padding: 5px;
        }
        .footer {
          text-align: center;
          margin-top: 10px;
          color: #666;
          font-size: 10px;
        }
        @media print {
          body {
            padding: 0;
          }
          .page-break {
            page-break-after: always;
          }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="title">速読 得点／時間 シート</div>
        <div class="subtitle">Score/Time Sheet for Speed Reading</div>
      </div>
      
      <div class="info-section">
        <div class="info-item">
          <span class="info-label">名前 (Name):</span>
          <span class="info-value">&nbsp;</span>
        </div>
        <div class="info-item">
          <span class="info-label">期間 (Period):</span>
          <span class="info-value">&nbsp;</span>
        </div>
      </div>
      
      <table class="main-table">
        <thead>
          <tr>
            <th rowspan="2" style="width: 80px;">日付<br>(Date)</th>
            <th colspan="3">1回目 (1st)</th>
            <th colspan="3">2回目 (2nd)</th>
            <th colspan="3">3回目 (3rd)</th>
            <th colspan="3">4回目 (4th)</th>
            <th colspan="3">5回目 (5th)</th>
          </tr>
          <tr>
            ${Array(5).fill(null).map(() => `
              <th style="width: 45px;">得点<br>(Score)</th>
              <th style="width: 45px;">時間<br>(Time)</th>
              <th style="width: 50px;">速度<br>(Speed)</th>
            `).join('')}
          </tr>
        </thead>
        <tbody>
          ${Array(15).fill(null).map((_, index) => `
            <tr>
              <td class="date-cell">&nbsp;</td>
              ${Array(5).fill(null).map(() => `
                <td class="data-cell">&nbsp;</td>
                <td class="data-cell">&nbsp;</td>
                <td class="data-cell">&nbsp;</td>
              `).join('')}
            </tr>
          `).join('')}
        </tbody>
      </table>
      
      <div class="notes-section">
        <div class="notes-title">メモ・備考 (Notes):</div>
        <div class="notes-lines">&nbsp;</div>
      </div>
      
      <div class="footer">
        Generated by 速読ゴリラ (Speed Reading Gorilla)
      </div>
    </body>
    </html>
  `;

  // 新しいウィンドウを開いて印刷
  const printWindow = window.open('', '_blank');
  if (printWindow) {
    printWindow.document.write(htmlContent);
    printWindow.document.close();
    
    // コンテンツが読み込まれるのを待ってから印刷
    printWindow.onload = () => {
      printWindow.print();
    };
  }
};